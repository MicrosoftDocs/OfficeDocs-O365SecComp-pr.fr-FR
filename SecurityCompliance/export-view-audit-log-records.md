---
title: Exporter, configurer et afficher les enregistrements du journal d’audit
ms.author: markjjo
author: markjjo
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection:
- Strat_O365_IP
- M365-security-compliance
search.appverid:
- MOE150
- MET150
ms.assetid: 0d4d0f35-390b-4518-800e-0c7ec95e946c
description: Après avoir exporté et téléchargé les résultats d’une recherche de journal d’audit Office 365 dans un fichier CSV, vous pouvez utiliser la fonctionnalité transformation JSON de l’éditeur de la requête Power dans Excel pour fractionner chaque propriété de l’objet JSON dans la colonne AuditData en sa propre colonne. Cela peut vous aider à localiser rapidement les données d’audit spécifiques que vous recherchez.
ms.openlocfilehash: 7dac373e8f25ead38dddbe2663e521b35b3153ef
ms.sourcegitcommit: b262d40f6daf06be26e7586f37b736e09f8a4511
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/02/2019
ms.locfileid: "35462903"
---
# <a name="export-configure-and-view-audit-log-records"></a><span data-ttu-id="ef21c-104">Exporter, configurer et afficher les enregistrements du journal d’audit</span><span class="sxs-lookup"><span data-stu-id="ef21c-104">Export, configure, and view audit log records</span></span>

<span data-ttu-id="ef21c-105">Une fois que vous avez effectué une recherche dans le journal d’audit Office 365 et que vous avez téléchargé les résultats de la recherche dans un fichier CSV, le fichier contient une colonne nommée **AuditData**, qui contient des informations supplémentaires sur chaque événement.</span><span class="sxs-lookup"><span data-stu-id="ef21c-105">After you search the Office 365 audit log and download the search results to a CSV file, the file contains a column named **AuditData**, which contains additional information about each event.</span></span> <span data-ttu-id="ef21c-106">Les données de cette colonne sont mises en forme comme un objet JSON, qui contient plusieurs propriétés configurées en tant que paires *propriété: valeur* séparées par des virgules.</span><span class="sxs-lookup"><span data-stu-id="ef21c-106">The data in this column is formatted as a JSON object, which contains multiple properties that are configured as *property:value* pairs separated by commas.</span></span> <span data-ttu-id="ef21c-107">Vous pouvez utiliser la fonctionnalité transformation JSON de l’éditeur Power Query dans Excel pour fractionner chaque propriété de l’objet JSON dans la colonne **AuditData** en plusieurs colonnes afin que chaque propriété dispose de sa propre colonne.</span><span class="sxs-lookup"><span data-stu-id="ef21c-107">You can use the JSON transform feature in the Power Query Editor in Excel to split each property in the JSON object in the **AuditData** column into multiple columns so that each property has its own column.</span></span> <span data-ttu-id="ef21c-108">Cela vous permet de trier et de filtrer sur une ou plusieurs de ces propriétés, qui peuvent vous aider à localiser rapidement les données d’audit spécifiques que vous recherchez.</span><span class="sxs-lookup"><span data-stu-id="ef21c-108">This lets you sort and filter on one or more of these properties, which can help you quickly locate the specific auditing data you're looking for.</span></span>

## <a name="step-1-export-audit-log-search-results"></a><span data-ttu-id="ef21c-109">Étape 1: exporter les résultats de la recherche du journal d’audit</span><span class="sxs-lookup"><span data-stu-id="ef21c-109">Step 1: Export audit log search results</span></span>

<span data-ttu-id="ef21c-110">La première étape consiste à rechercher dans le journal d’audit, puis à exporter les résultats dans un fichier de valeurs séparées par des virgules (CSV) sur votre ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="ef21c-110">The first step is to search the audit log and then export the results in a comma-separated value (CSV) file to your local computer.</span></span>
  
1. <span data-ttu-id="ef21c-111">Effectuez une [recherche dans le journal d’audit](search-the-audit-log-in-security-and-compliance.md#search-the-audit-log) et révisez les critères de recherche si nécessaire jusqu’à ce que vous ayez les résultats souhaités.</span><span class="sxs-lookup"><span data-stu-id="ef21c-111">Run an [audit log search](search-the-audit-log-in-security-and-compliance.md#search-the-audit-log) and revise the search criteria if necessary until you have the desired results.</span></span>
    
2. <span data-ttu-id="ef21c-112">Cliquez sur **Exporter les résultats** , puis sélectionnez **Télécharger tous les résultats**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-112">Click **Export results** and select **Download all results**.</span></span> 
    
   ![Cliquez sur Télécharger tous les résultats](media/ExportAuditSearchResults.png)

   <span data-ttu-id="ef21c-114">Cette option permet d’exporter tous les enregistrements d’audit à partir de la recherche de journal d’audit que vous avez exécutée à l’étape 1, et de télécharger les données brutes du journal d’audit dans un fichier CSV.</span><span class="sxs-lookup"><span data-stu-id="ef21c-114">This option to exports all the audit records from the audit log search you ran in step 1, and downloads the raw data from the audit log to a CSV file.</span></span> 

   <span data-ttu-id="ef21c-115">Un message s’affiche en bas de la fenêtre qui vous invite à ouvrir ou à enregistrer le fichier CSV.</span><span class="sxs-lookup"><span data-stu-id="ef21c-115">A message is displayed at the bottom of the window that prompts you to open or save the CSV file.</span></span> 

3. <span data-ttu-id="ef21c-116">Cliquez sur **enregistrer > enregistrer sous** et enregistrez le fichier CSV sur votre ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="ef21c-116">Click **Save > Save as** and save the CSV file to your local computer.</span></span> <span data-ttu-id="ef21c-117">Le téléchargement de nombreux résultats de recherche prend un certain temps.</span><span class="sxs-lookup"><span data-stu-id="ef21c-117">It takes a while to download many search results.</span></span> <span data-ttu-id="ef21c-118">C’est généralement le cas lors de la recherche de toutes les activités ou d’une plage de dates étendue.</span><span class="sxs-lookup"><span data-stu-id="ef21c-118">This is typically the case when searching for all activities or a broad date range.</span></span> <span data-ttu-id="ef21c-119">Un message en bas des fenêtres s’affiche lorsque le téléchargement du fichier CSV est terminé.</span><span class="sxs-lookup"><span data-stu-id="ef21c-119">A message at the bottom of the windows is displayed when the CSV file is finished downloading.</span></span>
 
   ![Message affiché lorsque le téléchargement du fichier CSV est terminé](media/ExportAuditSearchResultsFinish.png)

> [!NOTE]
  > <span data-ttu-id="ef21c-121">Vous pouvez télécharger un maximum de 50 000 entrées dans un fichier CSV à partir d’une seule recherche de journal d’audit.</span><span class="sxs-lookup"><span data-stu-id="ef21c-121">You can download a maximum of 50,000 entries to a CSV file from a single audit log search.</span></span> <span data-ttu-id="ef21c-122">Si 50 000 entrées sont téléchargées dans le fichier CSV, vous pouvez probablement supposer qu’il y a plus de 50 000 événements correspondant aux critères de recherche.</span><span class="sxs-lookup"><span data-stu-id="ef21c-122">If 50,000 entries are downloaded to the CSV file, you can probably assume there are more than 50,000 events that met the search criteria.</span></span> <span data-ttu-id="ef21c-123">Pour exporter plus de cette limite, essayez d’utiliser une plage de dates pour réduire le nombre d’enregistrements du journal d’audit.</span><span class="sxs-lookup"><span data-stu-id="ef21c-123">To export more than this limit, try using a date range to reduce the number of audit log records.</span></span> <span data-ttu-id="ef21c-124">Il se peut que vous deviez exécuter plusieurs recherches avec des plages de dates plus petites pour exporter plus de 50 000 entrées.</span><span class="sxs-lookup"><span data-stu-id="ef21c-124">You might have to run multiple searches with smaller date ranges to export more than 50,000 entries.</span></span>

## <a name="step-2-format-the-exported-audit-log-using-the-power-query-editor"></a><span data-ttu-id="ef21c-125">Étape 2: mettre en forme le journal d’audit exporté à l’aide de l’éditeur de requête Power</span><span class="sxs-lookup"><span data-stu-id="ef21c-125">Step 2: Format the exported audit log using the Power Query Editor</span></span>

<span data-ttu-id="ef21c-126">L’étape suivante consiste à utiliser la fonctionnalité transformation JSON de l’éditeur Power Query dans Excel pour fractionner chaque propriété de l’objet JSON dans la colonne **AuditData** en sa propre colonne.</span><span class="sxs-lookup"><span data-stu-id="ef21c-126">The next step is to use the JSON transform feature in the Power Query Editor in Excel to split each property in the JSON object in the **AuditData** column into its own column.</span></span> <span data-ttu-id="ef21c-127">Ensuite, filtrez les colonnes pour afficher les enregistrements en fonction des valeurs de propriétés spécifiques.</span><span class="sxs-lookup"><span data-stu-id="ef21c-127">Then you filter columns to view records based on the values of specific properties.</span></span> <span data-ttu-id="ef21c-128">Cela peut vous aider à localiser rapidement les données d’audit spécifiques que vous recherchez.</span><span class="sxs-lookup"><span data-stu-id="ef21c-128">This can help you quickly locate the specific auditing data you're looking for.</span></span>

1. <span data-ttu-id="ef21c-129">Ouvrez un classeur vierge dans Excel pour Office 365, Excel 2019 ou Excel 2016.</span><span class="sxs-lookup"><span data-stu-id="ef21c-129">Open a blank workbook in Excel for Office 365, Excel 2019, or Excel 2016.</span></span>
    
2.  <span data-ttu-id="ef21c-130">Sous l’onglet **données** , dans le groupe de rubans **obtenir des données de transformation de &** , cliquez sur **de texte/CSV**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-130">On the **Data** tab, in the **Get & Transform Data** ribbon group, click **From Text/CSV**.</span></span>

    ![Sous l’onglet données, cliquez sur de texte/CSV](media/JSONTransformOpenCSVFile.png)

3. <span data-ttu-id="ef21c-132">Ouvrez le fichier CSV que vous avez téléchargé à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="ef21c-132">Open the CSV file that you downloaded in Step 1.</span></span>
    
4. <span data-ttu-id="ef21c-133">Dans la fenêtre affichée, cliquez sur **transformer les données**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-133">In the window that's displayed, click **Transform Data**.</span></span>

   ![Cliquez sur transformer les données](media/JSONOpenPowerQuery.png)

<span data-ttu-id="ef21c-135">Le fichier CSV s’ouvre dans l' **éditeur de requête**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-135">The CSV file is opened in the **Query Editor**.</span></span> <span data-ttu-id="ef21c-136">Il existe quatre colonnes: **CreationDate**, **userids**, **Operations**et **AuditData**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-136">There are four columns: **CreationDate**, **UserIds**, **Operations**, and **AuditData**.</span></span> <span data-ttu-id="ef21c-137">La colonne **AuditData** est un objet JSON qui contient plusieurs propriétés.</span><span class="sxs-lookup"><span data-stu-id="ef21c-137">The **AuditData** column is a JSON object that contains multiple properties.</span></span> <span data-ttu-id="ef21c-138">L’étape suivante consiste à créer une colonne pour chaque propriété de l’objet JSON.</span><span class="sxs-lookup"><span data-stu-id="ef21c-138">The next step is to create a column for each property in the JSON object.</span></span>
    
5. <span data-ttu-id="ef21c-139">Cliquez avec le bouton droit sur le titre dans la colonne **AuditData** , cliquez sur **transformer**, puis sur **JSON**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-139">Right-click the title in the **AuditData** column, click **Transform**, and then click **JSON**.</span></span> 
 
   ![Cliquez avec le bouton droit sur la colonne AuditData, cliquez sur transformer, puis sélectionnez JSON](media/JSONTransform.png)

6. <span data-ttu-id="ef21c-141">Dans le coin supérieur droit de la colonne **AuditData** , cliquez sur l’icône développer.</span><span class="sxs-lookup"><span data-stu-id="ef21c-141">In the upper-right corner of the **AuditData** column, click the expand icon.</span></span>
    
   ![Dans la colonne AuditData, cliquez sur l’icône développer.](media/JSONTransformExpandIcon.png)

   <span data-ttu-id="ef21c-143">Une liste partielle des propriétés dans les objets JSON dans la colonne **AuditData** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="ef21c-143">A partial list of the properties in the JSON objects in the **AuditData** column is displayed.</span></span>

7. <span data-ttu-id="ef21c-144">Cliquez sur **charger plus** pour afficher toutes les propriétés dans les objets JSON dans la colonne **AuditData** .</span><span class="sxs-lookup"><span data-stu-id="ef21c-144">Click **Load more** to display all properties in the JSON objects in the **AuditData** column.</span></span>

   ![Cliquez sur charger plus pour afficher toutes les propriétés dans l’objet JSON.](media/JSONTransformLoadJSONProperties.png)

   <span data-ttu-id="ef21c-146">Vous pouvez désélectionner la case à cocher en regard d’une propriété que vous ne voulez pas inclure.</span><span class="sxs-lookup"><span data-stu-id="ef21c-146">You can unselect the checkbox next to any property that you don't want to include.</span></span> <span data-ttu-id="ef21c-147">La suppression des colonnes qui ne sont pas utiles pour votre enquête est un bon moyen de réduire la quantité de données affichées dans le journal d’audit.</span><span class="sxs-lookup"><span data-stu-id="ef21c-147">Eliminating columns that aren't useful for your investigation is a good way to reduce the amount of data displayed in the audit log.</span></span> 

   > [!NOTE]
   > <span data-ttu-id="ef21c-148">Les propriétés JSON affichées dans la capture d’écran précédente (après avoir cliqué sur **charger plus**) sont basées sur les propriétés figurant dans la colonne **AuditData** des premières lignes 1 000 du fichier CSV.</span><span class="sxs-lookup"><span data-stu-id="ef21c-148">The JSON properties displayed in the previous screenshot (after you click **Load more**) are based on the properties found in the **AuditData** column from the first 1,000 rows in the CSV file.</span></span> <span data-ttu-id="ef21c-149">S’il existe des propriétés JSON différentes dans les enregistrements après les 1 000 premières lignes, ces propriétés (et une colonne correspondante) ne sont pas incluses lorsque la colonne **AuditData** est fractionnée en plusieurs colonnes.</span><span class="sxs-lookup"><span data-stu-id="ef21c-149">If there are different JSON properties in records after the first 1,000 rows, these properties (and a corresponding column) won't be included when the **AuditData** column is split into multiple columns.</span></span> <span data-ttu-id="ef21c-150">Pour éviter cela, envisagez de réexécuter la recherche du journal d’audit et de limiter les critères de recherche afin d’obtenir des résultats moins nombreux.</span><span class="sxs-lookup"><span data-stu-id="ef21c-150">To help prevent this, consider re-running the audit log search and narrow the search criteria so that fewer records are returned.</span></span> <span data-ttu-id="ef21c-151">Une autre solution consiste à filtrer les éléments dans la colonne **opérations** afin de réduire le nombre de lignes (avant d’effectuer l’étape 5 ci-dessus) avant de transformer l’objet JSON dans la colonne **AuditData** .</span><span class="sxs-lookup"><span data-stu-id="ef21c-151">Another workaround is to filter items in the **Operations** column to reduce the number of rows (before you perform step 5 above) before transforming the JSON object in the **AuditData** column.</span></span>

8. <span data-ttu-id="ef21c-152">Effectuez l’une des opérations suivantes pour mettre en forme le titre des colonnes qui sont ajoutées pour chaque propriété JSON sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="ef21c-152">Do one of the following things to format the title of the columns that are added for each JSON property that's selected.</span></span>

    - <span data-ttu-id="ef21c-153">Désélectionnez la case à cocher utiliser le nom de la **colonne d’origine comme préfixe** pour utiliser le nom de la propriété JSON comme nom de colonne; par exemple, **RecordType** ou **sourceFileName**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-153">Unselect the **Use original column name as prefix** checkbox to use the name of the JSON property as the column names; for example, **RecordType** or **SourceFileName**.</span></span>
    
   - <span data-ttu-id="ef21c-154">Laissez la case à cocher **utiliser le nom de la colonne d’origine comme préfixe** sélectionnée pour ajouter le préfixe AuditData aux noms de colonne; par exemple, **AuditData. RecordType** ou **AuditData. sourceFileName**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-154">Leave the **Use original column name as prefix** checkbox selected to add the AuditData prefix to the column names; for example, **AuditData.RecordType** or **AuditData.SourceFileName**.</span></span>

9. <span data-ttu-id="ef21c-155">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="ef21c-155">Click **OK**.</span></span>
    
    <span data-ttu-id="ef21c-156">La colonne **AuditData** est divisée en plusieurs colonnes.</span><span class="sxs-lookup"><span data-stu-id="ef21c-156">The **AuditData** column is split into multiple columns.</span></span> <span data-ttu-id="ef21c-157">Chaque nouvelle colonne correspond à une propriété dans l’objet JSON AuditData.</span><span class="sxs-lookup"><span data-stu-id="ef21c-157">Each new column corresponds to a property in the AuditData JSON object.</span></span> <span data-ttu-id="ef21c-158">Chaque ligne de la colonne contient la valeur de la propriété.</span><span class="sxs-lookup"><span data-stu-id="ef21c-158">Each row in the column contains the value for the property.</span></span> <span data-ttu-id="ef21c-159">Si la propriété ne contient pas de valeur, la valeur *null* est affichée.</span><span class="sxs-lookup"><span data-stu-id="ef21c-159">If the property doesn't contain a value, the *null* value is displayed.</span></span> <span data-ttu-id="ef21c-160">Dans Excel, les cellules contenant des valeurs NULL sont vides.</span><span class="sxs-lookup"><span data-stu-id="ef21c-160">In Excel, cells with null values are empty.</span></span>
  
10. <span data-ttu-id="ef21c-161">Sous l’onglet **Accueil** , cliquez sur **Fermer & charger** pour fermer l’éditeur de requête Power et ouvrez le fichier CSV transformé dans un classeur Excel.</span><span class="sxs-lookup"><span data-stu-id="ef21c-161">On the **Home** tab, click **Close & Load** to close the Power Query Editor and open the transformed CSV file in an Excel workbook.</span></span> 

## <a name="tips-for-exporting-and-viewing-the-audit-log"></a><span data-ttu-id="ef21c-162">Conseils pour l’exportation et l’affichage du journal d’audit</span><span class="sxs-lookup"><span data-stu-id="ef21c-162">Tips for exporting and viewing the audit log</span></span>

<span data-ttu-id="ef21c-163">Voici quelques conseils et exemples d’exportation et d’affichage du journal d’audit avant et après l’utilisation de la fonctionnalité transformation JSON pour fractionner la colonne **AuditData** en plusieurs colonnes.</span><span class="sxs-lookup"><span data-stu-id="ef21c-163">Here are some tips and examples of exporting and viewing the audit log before and after you use the JSON transform feature to split the **AuditData** column into multiple columns.</span></span>

- <span data-ttu-id="ef21c-164">Filtrer la colonne **RecordType** pour afficher uniquement les enregistrements d’un service ou d’un domaine fonctionnel Office 365 spécifique.</span><span class="sxs-lookup"><span data-stu-id="ef21c-164">Filter the **RecordType** column to display only the records from a specific Office 365 service or functional area.</span></span> <span data-ttu-id="ef21c-165">Par exemple, pour afficher les événements liés au partage SharePoint, sélectionnez **14** (valeur d’énumération pour les enregistrements déclenchés par les activités de partage SharePoint).</span><span class="sxs-lookup"><span data-stu-id="ef21c-165">For example, to show events related to SharePoint sharing, you would select **14** (the enum value for records triggered by SharePoint sharing activities).</span></span> <span data-ttu-id="ef21c-166">Pour obtenir la liste des services Office 365 qui correspondent aux valeurs d’énumération affichées dans la colonne **RecordType** , voir [Propriétés détaillées dans le journal d’audit Office 365](detailed-properties-in-the-office-365-audit-log.md).</span><span class="sxs-lookup"><span data-stu-id="ef21c-166">For a list of the Office 365 services that correspond to the enum values displayed in the **RecordType** column, see [Detailed properties in the Office 365 audit log](detailed-properties-in-the-office-365-audit-log.md).</span></span>

- <span data-ttu-id="ef21c-167">Filtrez la colonne **opérations** pour afficher les enregistrements pour des activités spécifiques.</span><span class="sxs-lookup"><span data-stu-id="ef21c-167">Filter the **Operations** column to display the records for specific activities.</span></span> <span data-ttu-id="ef21c-168">Pour obtenir la liste de la plupart des opérations qui correspondent à une activité pouvant faire l’objet d’une recherche dans l’outil de recherche de journal d’audit dans le centre de sécurité & conformité, consultez la section «activités auditées» dans [Rechercher le journal d’audit dans le centre de conformité & de sécurité](search-the-audit-log-in-security-and-compliance.md#audited-activities).</span><span class="sxs-lookup"><span data-stu-id="ef21c-168">For a list of most operations that correspond to a searchable activity in the audit log search tool in the Security & Compliance Center, see the "Audited activities" section in [Search the audit log in the Security & Compliance Center](search-the-audit-log-in-security-and-compliance.md#audited-activities).</span></span>

- <span data-ttu-id="ef21c-169">Au lieu d’utiliser l’outil de recherche de journal d’audit dans le centre de sécurité & conformité, vous pouvez utiliser la cmdlet [Search-UnifiedAuditLog](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance-audit/search-unifiedauditlog) dans Exchange Online PowerShell pour exporter les résultats d’une recherche de journal d’audit Office 365 vers un fichier CSV.</span><span class="sxs-lookup"><span data-stu-id="ef21c-169">Instead of using the audit log search tool in the Security & Compliance Center, you can use the [Search-UnifiedAuditLog](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance-audit/search-unifiedauditlog) cmdlet in Exchange Online Powershell to export the results of an Office 365 audit log search to a CSV file.</span></span> <span data-ttu-id="ef21c-170">Vous pouvez ensuite suivre la même procédure que celle décrite à l’étape 2 pour mettre en forme le journal d’audit à l’aide de l’éditeur de requête Power.</span><span class="sxs-lookup"><span data-stu-id="ef21c-170">Then you can follow the same procedure described in Step 2 to format the audit log using the Power Query editor.</span></span> <span data-ttu-id="ef21c-171">L’un des avantages de l’utilisation de l’applet de commande PowerShell est que vous pouvez rechercher des événements à partir d’un service Office 365 spécifique à l’aide du paramètre *RecordType* .</span><span class="sxs-lookup"><span data-stu-id="ef21c-171">One advantage of using the PowerShell cmdlet is that you can search for events from a specific Office 365 service by using the *RecordType* parameter.</span></span> <span data-ttu-id="ef21c-172">Voici quelques exemples d’utilisation de PowerShell pour exporter des enregistrements d’audit dans un fichier CSV afin que vous puissiez utiliser l’éditeur de requête Power pour transformer l’objet JSON dans la colonne **AuditData** , comme décrit à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="ef21c-172">Here are few examples of using PowerShell to export audit records to a CSV file so you can use the Power Query editor to transform the JSON object in the **AuditData** column as described in Step 2.</span></span>

   <span data-ttu-id="ef21c-173">Dans cet exemple, exécutez les commandes suivantes pour renvoyer tous les enregistrements liés aux opérations de partage SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ef21c-173">In this example, run the following commands to return all records related to SharePoint sharing operations.</span></span> 
   
   ```
   $auditlog = Search-UnifiedAuditLog -StartDate 06/01/2019 -EndDate 06/30/2019 -RecordType SharePointSharingOperation
   ```

   ```
   $auditlog | Select-Object -Property CreationDate,UserIds,RecordType,AuditData | Export-Csv -Path c:\AuditLogs\PowerShellAuditlog.csv -NoTypeInformation
   ```

   - <span data-ttu-id="ef21c-174">Les résultats de la recherche sont exportés dans un fichier CSV nommé *PowerShellAuditlog* qui contient quatre colonnes: CreationDate, userids, RecordType, AuditData).</span><span class="sxs-lookup"><span data-stu-id="ef21c-174">The search results are exported to a CSV file named *PowerShellAuditlog* that contains four columns: CreationDate, UserIds, RecordType, AuditData).</span></span>

   - <span data-ttu-id="ef21c-175">Vous pouvez utiliser le nom ou la valeur d’énumération du type d’enregistrement comme valeur du paramètre *RecordType* .</span><span class="sxs-lookup"><span data-stu-id="ef21c-175">You can use the name or enum value for the record type as the value for the *RecordType* parameter.</span></span> <span data-ttu-id="ef21c-176">Pour obtenir la liste des noms de types d’enregistrements et leurs valeurs enum correspondantes, consultez la table *AuditLogRecordType* dans le schéma de l' [API activité de gestion d’Office 365](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#enum-auditlogrecordtype---type-edmint32).</span><span class="sxs-lookup"><span data-stu-id="ef21c-176">For a list of record type names and their corresponding enum values, see the *AuditLogRecordType* table in [Office 365 Management Activity API schema](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#enum-auditlogrecordtype---type-edmint32).</span></span>
   
   - <span data-ttu-id="ef21c-177">Vous ne pouvez inclure qu’une seule valeur pour ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="ef21c-177">You can only include a single value for this parameter.</span></span> <span data-ttu-id="ef21c-178">Pour rechercher des enregistrements d’audit pour d’autres types d’enregistrements, vous devez réexécuter les deux commandes précédentes pour spécifier un autre type d’enregistrement et ajouter ces résultats au fichier CSV d’origine.</span><span class="sxs-lookup"><span data-stu-id="ef21c-178">To search for audit records for other record types, you have to run the two previous commands again to specify a different record type and append those results to the original CSV file.</span></span> <span data-ttu-id="ef21c-179">Par exemple, vous pouvez exécuter ces deux commandes pour ajouter des activités de fichiers SharePoint à partir de la même plage de dates dans le fichier PowerShellAuditlog. csv.</span><span class="sxs-lookup"><span data-stu-id="ef21c-179">For example, you would run these two commands to add SharePoint file activities from the same date range to the PowerShellAuditlog.csv file.</span></span>

       ```
      $auditlog = Search-UnifiedAuditLog -StartDate 06/01/2019 -EndDate 06/30/2019 -RecordType SharePointFileOperation
      ```

      ```
      $auditlog | Select-Object -Property CreationDate,UserIds,RecordType,AuditData | Export-Csv -Append -Path c:\AuditLogs\PowerShellAuditlog.csv -NoTypeInformation
      ```
