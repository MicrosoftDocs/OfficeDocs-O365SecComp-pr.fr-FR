---
title: Recherche et suppression de messages - Aide de l’administrateur
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 12/20/2017
ms.audience: ITPro
ms.topic: article
ms.service: O365-seccomp
ms.collection: M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: 8c36bb03-e716-4fdd-9958-4aa7a2a1db42
description: Les administrateurs peuvent utiliser la cmdlet Search-Mailbox pour faire une recherche dans des boîtes aux lettres utilisateur, puis supprimer des messages d'une boîte aux lettres.
ms.openlocfilehash: abf7e7f39fe719ecc6c23565e284c01aed8822ee
ms.sourcegitcommit: 0017dc6a5f81c165d9dfd88be39a6bb17856582e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32260982"
---
# <a name="search-for-and-delete-messages---admin-help"></a><span data-ttu-id="5a4b5-103">Recherche et suppression de messages - Aide de l’administrateur</span><span class="sxs-lookup"><span data-stu-id="5a4b5-103">Search for and delete messages - Admin help</span></span>
  
<span data-ttu-id="5a4b5-104">Les administrateurs peuvent utiliser la cmdlet **Search-Mailbox** pour faire une recherche dans des boîtes aux lettres utilisateur, puis supprimer des messages d'une boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-104">Administrators can use the **Search-Mailbox** cmdlet to search user mailboxes and then delete messages from a mailbox.</span></span> 
  
<span data-ttu-id="5a4b5-p101">Pour rechercher et supprimer des messages en une seule étape, exécutez la cmdlet **Search-Mailbox** avec le commutateur  _DeleteContent_. Cependant, quand vous effectuez cette opération, vous ne pouvez ni afficher un aperçu des résultats ni générer un journal des messages qui seront renvoyés par la recherche, et vous pourriez supprimer des messages par inadvertance. Pour afficher un aperçu du journal des messages identifiés par la recherche avant qu'ils ne soient supprimés, exécutez la cmdlet **Search-Mailbox** avec le commutateur  _LogOnly_.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p101">To search and delete messages in one step, run the **Search-Mailbox** cmdlet with the  _DeleteContent_ switch. However, when you do this, you can't preview search results or generate a log of messages that will be returned by the search, and you may inadvertently delete messages that you didn't intend to. To preview a log of the messages found in the search before they're deleted, run the **Search-Mailbox** cmdlet with the  _LogOnly_ switch.</span></span> 
  
<span data-ttu-id="5a4b5-p102">Pour plus de sécurité, vous pouvez d'abord copier les messages vers une autre boîte aux lettres à l'aide des paramètres  _TargetMailbox_ et  _TargetFolder_. De cette manière, vous êtes assuré de conserver une copie des messages supprimés pour pouvoir y accéder ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p102">As an additional safeguard, you can first copy the messages to another mailbox by using the  _TargetMailbox_ and  _TargetFolder_ parameters. By doing this, you retain a copy of the deleted messages in case you need to access them again.</span></span> 
  
## <a name="before-you-begin"></a><span data-ttu-id="5a4b5-110">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="5a4b5-110">Before you begin</span></span>

- <span data-ttu-id="5a4b5-p103">Durée d'exécution estimée : 10 minutes. La durée réelle dépend de la taille de la boîte aux lettres et de la requête de recherche.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p103">Estimated time to complete: 10 minutes. The actual time may vary depending on the size of the mailbox and the search query.</span></span>
    
- <span data-ttu-id="5a4b5-p104">Vous ne pouvez pas utiliser le Centre d'administration Exchange (CAE) pour effectuer ces procédures. Vous devez utiliser l'environnement de ligne de commande Exchange Management Shell.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p104">You can't use the Exchange admin center (EAC) to perform these procedures. You must use the Shell.</span></span>
    
- <span data-ttu-id="5a4b5-115">Vous devez disposer des deux rôles de gestion suivants pour rechercher et supprimer des messages dans les boîtes aux lettres des utilisateurs :</span><span class="sxs-lookup"><span data-stu-id="5a4b5-115">You need to be assigned both of the following management roles to search for and delete messages in users' mailboxes:</span></span>
    
  - <span data-ttu-id="5a4b5-116">**Recherche de boîte aux lettres**-ce rôle vous permet de rechercher des messages dans plusieurs boîtes aux lettres de votre organisation.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-116">**Mailbox Search**- This role allows you to search for messages across multiple mailboxes in your organization.</span></span> <span data-ttu-id="5a4b5-117">Ce rôle n'est pas attribué par défaut aux administrateurs.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-117">Administrators aren't assigned this role by default.</span></span> <span data-ttu-id="5a4b5-118">Pour vous attribuer vous-même ce rôle afin de pouvoir rechercher les boîtes aux lettres, ajoutez-vous en tant que membre du groupe de rôles Gestion de la découverte.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-118">To assign yourself this role so that you can search mailboxes, add yourself as a member of the Discovery Management role group.</span></span> <span data-ttu-id="5a4b5-119">Voir [Ajouter un utilisateur au groupe de rôles gestion de la découverte](http://technet.microsoft.com/library/729e09d8-614b-431f-ae04-ae41fb4c628e.aspx).</span><span class="sxs-lookup"><span data-stu-id="5a4b5-119">See [Add a User to the Discovery Management Role Group](http://technet.microsoft.com/library/729e09d8-614b-431f-ae04-ae41fb4c628e.aspx).</span></span>
    
  - <span data-ttu-id="5a4b5-120">**Importation de boîte aux lettres** -ce rôle vous permet de supprimer des messages de la boîte aux lettres d'un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-120">**Mailbox Import Export** - This role allows you to delete messages from a user's mailbox.</span></span> <span data-ttu-id="5a4b5-121">Par défaut, ce rôle n'est attribué à aucun groupe de rôles.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-121">By default, this role isn't assigned to any role group.</span></span> <span data-ttu-id="5a4b5-122">Pour supprimer des messages des boîtes aux lettres des utilisateurs, vous pouvez ajouter le rôle Importation/Exportation de boîte aux lettres au groupe de rôles Gestion de l'organisation.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-122">To delete messages from users' mailboxes, you can add the Mailbox Import Export role to the Organization Management role group.</span></span> <span data-ttu-id="5a4b5-123">Pour plus d'informations, consultez la section «Ajouter un rôle à un groupe de rôles» dans [gérer des groupes de rôles](http://technet.microsoft.com/library/ab9b7a3b-bf67-4ba1-bde5-8e6ac174b82c.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5a4b5-123">For more information, see the "Add a role to a role group" section in [Manage Role Groups](http://technet.microsoft.com/library/ab9b7a3b-bf67-4ba1-bde5-8e6ac174b82c.aspx) .</span></span> 
    
- <span data-ttu-id="5a4b5-p107">Si la fonctionnalité de récupération d'élément unique est activée pour la boîte aux lettres dont vous souhaitez supprimer des messages, vous devez d'abord la désactiver. Pour plus d'informations, voir [Activation de la récupération d'élément unique pour une boîte aux lettres](http://technet.microsoft.com/library/2e7f1bcd-8395-45ad-86ce-22868bd46af0.aspx).</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p107">If the mailbox from which you want to delete messages has single item recovery enabled, you must first disable the feature. For more information, see [Enable or disable single item recovery for a mailbox](http://technet.microsoft.com/library/2e7f1bcd-8395-45ad-86ce-22868bd46af0.aspx).</span></span>
    
- <span data-ttu-id="5a4b5-126">Si la boîte aux lettres dont vous souhaitez supprimer des messages est mise en conservation, nous vous recommandons de vous informer préalablement auprès du service de gestion des enregistrements ou juridique avant de désactiver la mise en attente et de supprimer le contenu de la boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-126">If the mailbox from which you want to delete messages is placed on hold, we recommend that you check with your records management or legal department before removing the hold and deleting the mailbox content.</span></span> <span data-ttu-id="5a4b5-127">Une fois l'approbation obtenue, suivez les étapes décrites dans la rubrique [nettoyer le dossier éléments récupérables](http://technet.microsoft.com/library/82c310f8-de2f-46f2-8e1a-edb6055d6e69.aspx).</span><span class="sxs-lookup"><span data-stu-id="5a4b5-127">After you obtain approval, follow the steps listed in the topic [Clean Up the Recoverable Items Folder](http://technet.microsoft.com/library/82c310f8-de2f-46f2-8e1a-edb6055d6e69.aspx).</span></span>
    
- <span data-ttu-id="5a4b5-p109">Vous pouvez faire une recherche dans 10 000 boîtes aux lettres au maximum à l'aide de la cmdlet **Search-Mailbox**. Si vous êtes une organisation Exchange Online et que vous disposez de plus de 10 000 boîtes aux lettres, vous pouvez utiliser la fonctionnalité de recherche de conformité (ou la cmdlet **New-ComplianceSearch** correspondante) pour réaliser une recherche dans un nombre illimité de boîtes aux lettres. Vous pouvez ensuite utiliser la cmdlet **New-ComplianceSearchAction** pour supprimer les messages renvoyés par la recherche de conformité. Pour plus d'informations, reportez-vous à la rubrique [Recherche et suppression de messages électroniques dans votre organisation Office 365](https://go.microsoft.com/fwlink/p/?LinkId=786856).</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p109">You can search a maximum of 10,000 mailboxes using the **Search-Mailbox** cmdlet. If you're an Exchange Online organization and have more than 10,000 mailboxes, you can use the Compliance Search feature (or the corresponding **New-ComplianceSearch** cmdlet) to search an unlimited number of mailboxes. Then you can use the **New-ComplianceSearchAction** cmdlet to delete the messages returned by a compliance search. For more information, see [Search for and delete email messages from your Office 365 organization](https://go.microsoft.com/fwlink/p/?LinkId=786856).</span></span>
    
- <span data-ttu-id="5a4b5-p110">Si vous incluez une requête de recherche (à l'aide du paramètre  *SearchQuery*  ), la cmdlet **Search-Mailbox** renverra au maximum 10 000 éléments dans les résultats de recherche. Ainsi, si vous incluez une requête de recherche, vous devrez peut-être exécuter la commande **Search-Mailbox** plusieurs fois pour supprimer plus de 10 000 éléments.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p110">If you include a search query (by using the  *SearchQuery*  parameter), the **Search-Mailbox** cmdlet will return a maximum of 10,000 items in the search results. Therefore if you include a search query, you might have to run the **Search-Mailbox** command multiple times to delete more than 10,000 items.</span></span> 
    
- <span data-ttu-id="5a4b5-134">La boîte aux lettres d'archivage de l'utilisateur est également incluse dans la recherche quand vous exécutez la cmdlet **Search-Mailbox**.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-134">The user's archive mailbox will also be searched when you run the **Search-Mailbox** cmdlet.</span></span> <span data-ttu-id="5a4b5-135">De même, les éléments de la boîte aux lettres d'archivage principale sont supprimés quand vous utilisez la cmdlet **Search-Mailbox** avec le commutateur  _DeleteContent_.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-135">Similarly, items in the primary archive mailbox will be deleted when you use the **Search-Mailbox** cmdlet with the  _DeleteContent_ switch.</span></span> <span data-ttu-id="5a4b5-136">Pour éviter cela, vous pouvez inclure le commutateur  *DoNotIncludeArchive*  .</span><span class="sxs-lookup"><span data-stu-id="5a4b5-136">To prevent this, you can include the  *DoNotIncludeArchive*  switch.</span></span> <span data-ttu-id="5a4b5-137">Par ailleurs, nous vous recommandons de ne pas utiliser le commutateur _DeleteContent_ pour supprimer les messages dans les boîtes aux lettres Exchange Online dont l'archivage est automatiquement étendu, car une perte de données inattendue peut se produire.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-137">Also, we recommend that you don't use the  _DeleteContent_ switch to delete messages in Exchange Online mailboxes that have auto-expanding archiving enabled because unexpected data loss may occur.</span></span> 
    
## <a name="search-messages-and-log-the-search-results"></a><span data-ttu-id="5a4b5-138">Rechercher des messages et enregistrer les résultats de la recherche</span><span class="sxs-lookup"><span data-stu-id="5a4b5-138">Search messages and log the search results</span></span>

<span data-ttu-id="5a4b5-p112">Cet exemple permet d'effectuer une recherche dans la boîte aux lettres d'April Stewart au niveau des messages dont le champ Objet contient l'expression « Your bank statement » (Votre relevé de compte) et de consigner les résultats de la recherche dans le dossier SearchAndDeleteLog de la boîte aux lettres de l'administrateur. Les messages ne sont ni copiés ni supprimés de la boîte aux lettres cible.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p112">This example searches April Stewart's mailbox for messages that contain the phrase "Your bank statement" in the Subject field and logs the search results in the SearchAndDeleteLog folder of the administrator's mailbox. Messages aren't copied to or deleted from the target mailbox.</span></span>
  
```
Search-Mailbox -Identity "April Stewart" -SearchQuery 'Subject:"Your bank statement"' -TargetMailbox administrator -TargetFolder "SearchAndDeleteLog" -LogOnly -LogLevel Full
```

<span data-ttu-id="5a4b5-141">Cet exemple permet d'effectuer une recherche dans toutes les boîtes aux lettres de l'organisation au niveau des messages comprenant n'importe quel type de fichier joint qui contient le mot « Trojan » dans le nom de fichier et envoie un message de journal à la boîte aux lettres de l'administrateur.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-141">This example searches all mailboxes in the organization for messages that have any type of attached file that contains the word "Trojan" in the filename and sends a log message to the administrator's mailbox.</span></span>
  
```
Get-Mailbox -ResultSize unlimited | Search-Mailbox -SearchQuery attachment:trojan* -TargetMailbox administrator -TargetFolder "SearchAndDeleteLog" -LogOnly -LogLevel Full
```

<span data-ttu-id="5a4b5-142">Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [Search-Mailbox](http://technet.microsoft.com/library/9ee3b02c-d343-4816-a583-a90b1fad4b26.aspx).</span><span class="sxs-lookup"><span data-stu-id="5a4b5-142">For detailed syntax and parameter information, see [Search-Mailbox](http://technet.microsoft.com/library/9ee3b02c-d343-4816-a583-a90b1fad4b26.aspx).</span></span>
  
 
## <a name="search-and-delete-messages"></a><span data-ttu-id="5a4b5-143">Rechercher et supprimer des messages</span><span class="sxs-lookup"><span data-stu-id="5a4b5-143">Search and delete messages</span></span>

<span data-ttu-id="5a4b5-p113">Cet exemple permet d'effectuer une recherche dans la boîte aux lettres d'April Stewart au niveau des messages dont le champ Objet contient l'expression « Your bank statement » et de supprimer les messages de la boîte aux lettres source sans copier les résultats de la recherche dans un autre dossier. Comme expliqué précédemment, le rôle de gestion Importation/Exportation de boîte aux lettres doit vous avoir été attribué pour que vous puissiez supprimer des messages de la boîte aux lettres d'un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p113">This example searches April Stewart's mailbox for messages that contain the phrase "Your bank statement" in the Subject field and deletes the messages from the source mailbox without copying the search results to another folder. As previously explained, you need to be assigned the Mailbox Import Export management role to delete messages from a user's mailbox.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="5a4b5-p114">Quand vous utilisez la cmdlet **Search-Mailbox** avec le commutateur  _DeleteContent_, les messages sont définitivement supprimés de la boîte aux lettres source. Avant de supprimer définitivement des messages, nous vous conseillons d'utiliser le commutateur  _LogOnly_ pour générer un journal des messages identifiés lors de la recherche avant qu'ils ne soient supprimés ou de copier les messages vers une autre boîte aux lettres avant leur suppression de la boîte aux lettres source.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p114">When you use the **Search-Mailbox** cmdlet with the  _DeleteContent_ switch, messages are permanently deleted from the source mailbox. Before you permanently delete messages, we recommend that you either use the  _LogOnly_ switch to generate a log of the messages found in the search before they're deleted or copy the messages to another mailbox before deleting them from the source mailbox.</span></span> 
  
```
Search-Mailbox -Identity "April Stewart" -SearchQuery 'Subject:"Your bank statement"' -DeleteContent
```

<span data-ttu-id="5a4b5-148">Cet exemple permet d'effectuer une recherche dans la boîte aux lettres d'April Stewart au niveau des messages dont le champ Objet contient l'expression « Your bank statement », de copier les résultats de la recherche dans le dossier AprilStewart-DeletedMessages de la boîte aux lettres BackupMailbox et de supprimer les messages de la boîte aux lettres d'April.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-148">This example searches April Stewart's mailbox for messages that contain the phrase "Your bank statement" in the Subject field, copies the search results to the folder AprilStewart-DeletedMessages in the mailbox BackupMailbox, and deletes the messages from April's mailbox.</span></span>
  
```
Search-Mailbox -Identity "April Stewart" -SearchQuery 'Subject:"Your bank statement"' -TargetMailbox "BackupMailbox" -TargetFolder "AprilStewart-DeletedMessages" -LogLevel Full -DeleteContent
```

<span data-ttu-id="5a4b5-149">Cet exemple permet d'effectuer une recherche dans toutes les boîtes aux lettres de l'organisation au niveau des messages ayant pour objet « Download this file » et les supprime définitivement.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-149">This example searches all mailboxes in the organization for messages with the subject line "Download this file", and then permanently deletes them.</span></span> 
  
```
Get-Mailbox -ResultSize unlimited | Search-Mailbox -SearchQuery 'Subject:"Download this file"' -DeleteContent
```

<span data-ttu-id="5a4b5-150">Pour obtenir des informations détaillées sur la syntaxe et les paramètres, consultez la rubrique [Search-Mailbox](http://technet.microsoft.com/library/9ee3b02c-d343-4816-a583-a90b1fad4b26.aspx).</span><span class="sxs-lookup"><span data-stu-id="5a4b5-150">For detailed syntax and parameter information, see [Search-Mailbox](http://technet.microsoft.com/library/9ee3b02c-d343-4816-a583-a90b1fad4b26.aspx).</span></span>

## <a name="using-the--loglevel-full-parameter"></a><span data-ttu-id="5a4b5-151">Utilisation du paramètre -LogLevel Full</span><span class="sxs-lookup"><span data-stu-id="5a4b5-151">Using the -LogLevel Full parameter</span></span>

<span data-ttu-id="5a4b5-p115">Dans certains des exemples ci-dessus, le paramètre  _LogLevel_ avec la valeur  `Full` est utilisé pour consigner des informations détaillées concernant les résultats renvoyés par la cmdlet **Search-Mailbox**. Lorsque vous incluez ce paramètre, un courrier électronique est créé et envoyé à la boîte aux lettres spécifiée par le paramètre  _TargetMailbox_. Le fichier journal (au format CSV nommé Résultats recherche.csv) est joint au courrier électronique et est disponible dans le dossier indiqué par le paramètre  _TargetFolder_. Le fichier journal comporte une ligne par message inclus dans les résultats de la recherche lorsque vous exécutez la cmdlet **Search-Mailbox**.</span><span class="sxs-lookup"><span data-stu-id="5a4b5-p115">In some of the previous examples, the  _LogLevel_ parameter, with the  `Full` value is used to log detailed information about the results returned by the **Search-Mailbox** cmdlet. When you included this parameter, an email message is created and sent to the mailbox specified by the  _TargetMailbox_ parameter. The log file (which is a CSV-formatted file named Search Results.csv) is attached to this email message, and will be located in the folder specified by the  _TargetFolder_ parameter. The log file contains a row for each message that's included in the search results when you run the **Search-Mailbox** cmdlet.</span></span> 
