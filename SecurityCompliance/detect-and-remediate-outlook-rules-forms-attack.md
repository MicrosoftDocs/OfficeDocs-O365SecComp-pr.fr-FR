---
title: Détecter et résoudre les attaques d’injections de formulaires personnalisés et de règles Outlook dans Office 365
ms.author: chrfox
author: chrfox
manager: laurawi
ms.date: 04/23/2018
ms.audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: Découvrez comment reconnaître et corriger les attaques d’injections de formulaires personnalisés et de règles Outlook dans Office 365
ms.openlocfilehash: 2189ff7abd640d9c87b97df35ec2b9cd44c74061
ms.sourcegitcommit: c7989a8ead235aaebb2503abbde598f2c26c0056
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/14/2019
ms.locfileid: "33979490"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks-in-office-365"></a><span data-ttu-id="4b32c-103">Détecter et résoudre les attaques par injections sur les règles d’Outlook et les formulaires personnalisés dans Office 365</span><span class="sxs-lookup"><span data-stu-id="4b32c-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks in Office 365</span></span>

<span data-ttu-id="4b32c-104">**Résumé** Découvrez comment reconnaître et corriger les attaques d’injections de formulaires personnalisés et de règles Outlook dans Office 365.</span><span class="sxs-lookup"><span data-stu-id="4b32c-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="4b32c-105">Qu’est-ce que les règles Outlook et les attaques par injection de formulaires personnalisés?</span><span class="sxs-lookup"><span data-stu-id="4b32c-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>
<span data-ttu-id="4b32c-106">Une fois qu’un agresseur a enfreint un compte de votre location et que vous vous trouvez dans, il y a un moyen d’essayer de revenir sur ou de revenir une fois qu’il a été découvert et supprimé.</span><span class="sxs-lookup"><span data-stu-id="4b32c-106">After an attacker has breached an account in your tenancy and gets in, they're are going to try and establish a way to stay in or a way to get back in after they are discovered and removed.</span></span> <span data-ttu-id="4b32c-107">Il s’agit de l’établissement d’un mécanisme de persistance.</span><span class="sxs-lookup"><span data-stu-id="4b32c-107">This is called establishing a persistence mechanism.</span></span> <span data-ttu-id="4b32c-108">Il existe deux façons de le faire en exploitant les règles Outlook ou en injectant des formulaires personnalisés dans Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-108">Two ways that they can do this are by exploiting Outlook rules or by injecting custom forms into Outlook.</span></span>
<span data-ttu-id="4b32c-109">Dans les deux cas, la règle ou le formulaire est synchronisé à partir du service Cloud vers le client de bureau, de sorte qu’un format complet et une réinstallation du logiciel client n’éliminent pas le mécanisme d’injection.</span><span class="sxs-lookup"><span data-stu-id="4b32c-109">In both cases, the rule or form is synced from the cloud service down to the desktop client, so a full format and re-install of the client software doesn't eliminate the injection mechanism.</span></span> <span data-ttu-id="4b32c-110">Cela est dû au fait que lorsque le logiciel client Outlook se reconnecte à la boîte aux lettres dans le Cloud, il télécharge de nouveau les règles et les formulaires à partir du Cloud.</span><span class="sxs-lookup"><span data-stu-id="4b32c-110">This is because when the Outlook client software reconnects to the mailbox in the cloud it will re-download the rules and forms from the cloud.</span></span> <span data-ttu-id="4b32c-111">Une fois que les règles et les formulaires sont en place, l’agresseur les utilise pour exécuter du code distant ou personnalisé, généralement pour installer des programmes malveillants sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="4b32c-111">Once the rules and forms are in place, the attacker uses them to execute remote or custom code, usually to install malware on the local machine.</span></span> <span data-ttu-id="4b32c-112">Le programme malveillant revole ensuite les informations d’identification ou effectue une autre activité illicite.</span><span class="sxs-lookup"><span data-stu-id="4b32c-112">The malware then re-steals credentials or performs other illicit activity.</span></span> <span data-ttu-id="4b32c-113">La bonne nouvelle est que si vous maintenez vos clients patchés vers la dernière version, vous n’êtes pas vulnérable à la menace comme les valeurs par défaut du client Outlook bloquent les deux mécanismes.</span><span class="sxs-lookup"><span data-stu-id="4b32c-113">The good news here is that if you keep your clients patched to the latest version, you are not vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span> 

<span data-ttu-id="4b32c-114">Les attaques suivent généralement ces modèles:</span><span class="sxs-lookup"><span data-stu-id="4b32c-114">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="4b32c-115">Exploitation des règles</span><span class="sxs-lookup"><span data-stu-id="4b32c-115">The Rules Exploit</span></span>
1. <span data-ttu-id="4b32c-116">L’agresseur vole le nom d’utilisateur et le mot de passe de l’un de vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4b32c-116">The attacker steals the username and password of one of your users.</span></span>
2. <span data-ttu-id="4b32c-117">L’agresseur se connecte ensuite à la boîte aux lettres Exchange de ces utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4b32c-117">The attacker then signs in to that users Exchange mailbox.</span></span> <span data-ttu-id="4b32c-118">La boîte aux lettres peut être dans Exchange Online ou dans Exchange en local.</span><span class="sxs-lookup"><span data-stu-id="4b32c-118">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>
3. <span data-ttu-id="4b32c-119">L’agresseur crée ensuite une règle de transfert dans la boîte aux lettres qui est déclenchée lorsque la boîte aux lettres reçoit un e-mail correspondant aux critères de la règle.</span><span class="sxs-lookup"><span data-stu-id="4b32c-119">The attacker then creates a forwarding rule in the mailbox that is triggered when the mailbox receives an email that matches the criteria of the rule.</span></span> <span data-ttu-id="4b32c-120">Les critères de règle et le contenu du déclencheur de messagerie sont conçus pour les deux.</span><span class="sxs-lookup"><span data-stu-id="4b32c-120">The criteria of rule and the contents of the trigger email are tailor-made for each other.</span></span>
4. <span data-ttu-id="4b32c-121">L’agresseur envoie le message du déclencheur à l’utilisateur qui utilise sa boîte aux lettres normalement.</span><span class="sxs-lookup"><span data-stu-id="4b32c-121">The attacker sends the trigger email to the user who is using their mailbox normally.</span></span>
5. <span data-ttu-id="4b32c-122">Lorsque le message électronique est reçu, la règle est déclenchée.</span><span class="sxs-lookup"><span data-stu-id="4b32c-122">When the email is received, the rule is triggered.</span></span> <span data-ttu-id="4b32c-123">L’action de la règle consiste généralement à lancer une application sur un serveur distant (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="4b32c-123">The action of the rule is usually to launch an application on a remote (WebDAV) server.</span></span>
6. <span data-ttu-id="4b32c-124">L’application installe généralement des programmes malveillants, tels que [PowerShell Empire](https://www.powershellempire.com/), localement sur l’ordinateur de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b32c-124">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user’s machine.</span></span>
7. <span data-ttu-id="4b32c-125">Le programme malveillant permet à l’agresseur de revoler le nom d’utilisateur et le mot de passe de l’utilisateur ou d’autres informations d’identification à partir de l’ordinateur local et d’effectuer d’autres activités malveillantes.</span><span class="sxs-lookup"><span data-stu-id="4b32c-125">The malware allows the attacker to re-steal the user’s username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="4b32c-126">Exploit des formulaires</span><span class="sxs-lookup"><span data-stu-id="4b32c-126">The Forms Exploit</span></span>
1. <span data-ttu-id="4b32c-127">L’agresseur vole le nom d’utilisateur et le mot de passe de l’un de vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4b32c-127">The attacker steals the username and password of one of your users.</span></span>
2. <span data-ttu-id="4b32c-128">L’agresseur se connecte ensuite à la boîte aux lettres Exchange de ces utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4b32c-128">The attacker then sign in to that users Exchange mailbox.</span></span> <span data-ttu-id="4b32c-129">La boîte aux lettres peut être dans Exchange Online ou dans Exchange en local.</span><span class="sxs-lookup"><span data-stu-id="4b32c-129">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>
3. <span data-ttu-id="4b32c-130">L’agresseur crée ensuite un modèle de formulaire de messagerie personnalisé et l’insère dans la boîte aux lettres de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b32c-130">The attacker then creates a custom mail form template and inserts it into the user’s mailbox.</span></span>  <span data-ttu-id="4b32c-131">Le formulaire personnalisé est déclenché lorsque la boîte aux lettres reçoit un message électronique qui exige que la boîte aux lettres charge le formulaire personnalisé.</span><span class="sxs-lookup"><span data-stu-id="4b32c-131">The custom form is triggered when the mailbox receives an email that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="4b32c-132">Le formulaire personnalisé et le format des courriers électroniques sont conçus pour les deux.</span><span class="sxs-lookup"><span data-stu-id="4b32c-132">The custom form and the format of email are tailor-made for each other.</span></span>
4. <span data-ttu-id="4b32c-133">L’agresseur envoie le message de déclenchement à l’utilisateur qui utilise normalement sa boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="4b32c-133">The attacker sends the trigger email to the user, who is using their mailbox normally.</span></span>
5. <span data-ttu-id="4b32c-134">Lorsque le message électronique est reçu, le formulaire est chargé.</span><span class="sxs-lookup"><span data-stu-id="4b32c-134">When the email is received, the form is loaded.</span></span> <span data-ttu-id="4b32c-135">Le formulaire lance une application sur un serveur distant (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="4b32c-135">The form launches an application on a remote (WebDAV) server.</span></span>
6. <span data-ttu-id="4b32c-136">L’application installe généralement des programmes malveillants, tels que [PowerShell Empire](https://www.powershellempire.com/), localement sur l’ordinateur de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b32c-136">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user’s machine.</span></span>
7. <span data-ttu-id="4b32c-137">Le programme malveillant permet à l’agresseur de revoler le nom d’utilisateur et le mot de passe de l’utilisateur ou d’autres informations d’identification à partir de l’ordinateur local et d’effectuer d’autres activités malveillantes.</span><span class="sxs-lookup"><span data-stu-id="4b32c-137">The malware allows the attacker to re-steal the user’s username and password or other credentials from local machine and perform other malicious activities.</span></span>


## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="4b32c-138">Quelles sont les règles et les attaques par injection de formulaires personnalisés qui peuvent ressembler à Office 365?</span><span class="sxs-lookup"><span data-stu-id="4b32c-138">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="4b32c-139">Il est peu probable que ces mécanismes de persistance soient remarqués par vos utilisateurs et, dans certains cas, ils ne soient pas visibles.</span><span class="sxs-lookup"><span data-stu-id="4b32c-139">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span>  <span data-ttu-id="4b32c-140">Cet article vous indique comment rechercher les sept signes (indicateurs de compromis) ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="4b32c-140">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="4b32c-141">Si vous trouvez l’un de ces éléments, vous devez prendre des mesures de correction.</span><span class="sxs-lookup"><span data-stu-id="4b32c-141">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="4b32c-142">Indicateurs des règles compromis</span><span class="sxs-lookup"><span data-stu-id="4b32c-142">Indicators of the Rules compromise</span></span>
    - <span data-ttu-id="4b32c-143">L’action de la règle consiste à démarrer une application.</span><span class="sxs-lookup"><span data-stu-id="4b32c-143">Rule Action is to start an application.</span></span>
    - <span data-ttu-id="4b32c-144">La règle fait référence à un EXE, un ZIP ou une URL.</span><span class="sxs-lookup"><span data-stu-id="4b32c-144">Rule References an EXE, ZIP, or URL.</span></span>
    - <span data-ttu-id="4b32c-145">Sur l’ordinateur local, recherchez les démarrages de nouveau processus issus du PID Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-145">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>
- <span data-ttu-id="4b32c-146">Indicateurs des formulaires personnalisés compromis</span><span class="sxs-lookup"><span data-stu-id="4b32c-146">Indicators of the Custom forms compromise</span></span> 
    - <span data-ttu-id="4b32c-147">Formulaire personnalisé présent enregistré comme sa propre classe de message.</span><span class="sxs-lookup"><span data-stu-id="4b32c-147">Custom form present saved as their own message class.</span></span>
    - <span data-ttu-id="4b32c-148">La classe de message contient du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="4b32c-148">Message class contains executable code.</span></span>
    - <span data-ttu-id="4b32c-149">Généralement stocké dans les dossiers de la boîte de réception ou de la bibliothèque des formulaires personnels.</span><span class="sxs-lookup"><span data-stu-id="4b32c-149">Usually stored in Personal Forms Library or Inbox folders.</span></span>
    - <span data-ttu-id="4b32c-150">Le formulaire est appelé IPM. Note. [nom personnalisé].</span><span class="sxs-lookup"><span data-stu-id="4b32c-150">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="4b32c-151">Étapes permettant de trouver des signes de cette attaque et de la confirmer</span><span class="sxs-lookup"><span data-stu-id="4b32c-151">Steps for finding signs of this attack and confirming it</span></span>
<span data-ttu-id="4b32c-152">Vous pouvez utiliser l’une ou l’autre de ces deux méthodes pour confirmer l’attaque.</span><span class="sxs-lookup"><span data-stu-id="4b32c-152">You can use either of these two methods to confirm the attack.</span></span>
- <span data-ttu-id="4b32c-153">Examinez manuellement les règles et les formulaires de chaque boîte aux lettres à l’aide du client Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-153">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span>  <span data-ttu-id="4b32c-154">Cette méthode est exhaustive, mais vous pouvez vérifier uniquement l’utilisateur de boîte aux lettres à la fois, ce qui peut prendre beaucoup de temps si vous avez un grand nombre d’utilisateurs à vérifier.</span><span class="sxs-lookup"><span data-stu-id="4b32c-154">This method is thorough, but you can only check mailbox user at a time which can be very time consuming if you have many users to check.</span></span>  <span data-ttu-id="4b32c-155">Cela peut également entraîner une violation de l’ordinateur à partir duquel vous exécutez la vérification.</span><span class="sxs-lookup"><span data-stu-id="4b32c-155">It can also result in a breach of the computer that you are running the check from.</span></span>
- <span data-ttu-id="4b32c-156">Utilisez le script PowerShell [Get-AllTenantRulesAndForms. ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) pour vider automatiquement toutes les règles de transfert de courrier et les formulaires personnalisés pour tous les utilisateurs de votre client.</span><span class="sxs-lookup"><span data-stu-id="4b32c-156">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="4b32c-157">Il s’agit de la méthode la plus rapide et la plus sécurisée avec la charge minimale.</span><span class="sxs-lookup"><span data-stu-id="4b32c-157">This is the fastest and safest method with the least amount of overhead.</span></span>


### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="4b32c-158">Confirmer l’attaque des règles à l’aide du client Outlook</span><span class="sxs-lookup"><span data-stu-id="4b32c-158">Confirm the Rules Attack Using the Outlook client</span></span>
1. <span data-ttu-id="4b32c-159">Ouvrez le client Outlook utilisateurs en tant qu’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b32c-159">Open the users Outlook client as the user.</span></span>  <span data-ttu-id="4b32c-160">L’utilisateur peut avoir besoin de votre aide pour examiner les règles de sa boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="4b32c-160">The user may need your help in examining the rules on their mailbox.</span></span>
2. <span data-ttu-id="4b32c-161">Reportez-vous à l’article [gérer les messages électroniques à l’aide des règles](https://support.office.com/article/manage-email-messages-by-using-rules-c24f5dea-9465-4df4-ad17-a50704d66c59#ID0EAABAAA=2010) pour les procédures relatives à l’ouverture de l’interface des règles dans les versions 2007, 2010 ou 2013 d’Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-161">Refer to [Manage email messages by using rules](https://support.office.com/article/manage-email-messages-by-using-rules-c24f5dea-9465-4df4-ad17-a50704d66c59#ID0EAABAAA=2010) article for the procedures on how to open the rules interface in either the 2007, 2010 or 2013 versions of Outlook.</span></span>
3. <span data-ttu-id="4b32c-162">Recherchez les règles que l’utilisateur n’a pas créées, ou toute règle ou règle inattendue avec des noms suspects.</span><span class="sxs-lookup"><span data-stu-id="4b32c-162">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>
4. <span data-ttu-id="4b32c-163">Recherchez dans la description de règle les actions de règle qui commencent et application ou font référence à un. EXE,. Fichier ZIP ou pour lancer une URL.</span><span class="sxs-lookup"><span data-stu-id="4b32c-163">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>
5. <span data-ttu-id="4b32c-164">Recherchez les nouveaux processus qui commencent à utiliser l’ID de processus Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-164">Look for any new processes that start using the Outlook process ID.</span></span>  <span data-ttu-id="4b32c-165">Reportez-vous à [Rechercher l’ID de processus](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span><span class="sxs-lookup"><span data-stu-id="4b32c-165">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="4b32c-166">Étapes pour confirmer l’attaque de formulaires à l’aide du client Outlook</span><span class="sxs-lookup"><span data-stu-id="4b32c-166">Steps to confirm the Forms attack using the Outlook client</span></span>
1. <span data-ttu-id="4b32c-167">Ouvrez le client Outlook utilisateur en tant qu’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b32c-167">Open the user Outlook client as the user.</span></span>
2. <span data-ttu-id="4b32c-168">Suivez les étapes décrites dans, [afficher l’onglet Développeur](https://support.office.com/article/show-the-developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45) pour la version des utilisateurs d’Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-168">Follow the steps in, [Show the Developer tab](https://support.office.com/article/show-the-developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45) for the users version of Outlook.</span></span>
3. <span data-ttu-id="4b32c-169">Ouvrez l’onglet Développeur maintenant visible dans Outlook, puis cliquez sur **créer un formulaire**.</span><span class="sxs-lookup"><span data-stu-id="4b32c-169">Open the now visible developer tab in Outlook and click **design a form**.</span></span>
4. <span data-ttu-id="4b32c-170">Sélectionnez la **boîte de réception** dans la liste **regarder dans** .</span><span class="sxs-lookup"><span data-stu-id="4b32c-170">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="4b32c-171">Recherchez les formulaires personnalisés.</span><span class="sxs-lookup"><span data-stu-id="4b32c-171">Look for any custom forms.</span></span>  <span data-ttu-id="4b32c-172">Les formulaires personnalisés sont assez rares pour que si vous avez du tout des formulaires personnalisés, l’aspect est plus approfondi.</span><span class="sxs-lookup"><span data-stu-id="4b32c-172">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>
5. <span data-ttu-id="4b32c-173">Examinez les formulaires personnalisés, en particulier ceux marqués comme masqués.</span><span class="sxs-lookup"><span data-stu-id="4b32c-173">Investigate any custom forms, especially those marked as hidden.</span></span>
6. <span data-ttu-id="4b32c-174">Ouvrez tous les formulaires personnalisés et, dans le groupe **formulaire** , cliquez sur **afficher le code** pour afficher les éléments exécutés lors du chargement du formulaire.</span><span class="sxs-lookup"><span data-stu-id="4b32c-174">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="4b32c-175">Étapes à suivre pour vérifier les règles et les attaques de formulaires à l’aide de PowerShell</span><span class="sxs-lookup"><span data-stu-id="4b32c-175">Steps to confirm the Rules and Forms attack using PowerShell</span></span>
<span data-ttu-id="4b32c-176">Le moyen le plus simple de vérifier une attaque de règles ou de formulaires personnalisés consiste à exécuter le script PowerShell [Get-AllTenantRulesAndForms. ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) .</span><span class="sxs-lookup"><span data-stu-id="4b32c-176">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span>  <span data-ttu-id="4b32c-177">Ce script se connecte à chaque boîte aux lettres de votre client et transfère toutes les règles et les formulaires dans deux fichiers. csv.</span><span class="sxs-lookup"><span data-stu-id="4b32c-177">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="4b32c-178">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="4b32c-178">Pre-requisites</span></span>
<span data-ttu-id="4b32c-179">Vous devez disposer des droits d’administrateur général pour exécuter le script, car le script se connecte à chaque boîte aux lettres dans le client pour lire les règles et les formulaires.</span><span class="sxs-lookup"><span data-stu-id="4b32c-179">You will need to have a global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="4b32c-180">Connectez-vous à l’ordinateur à partir duquel vous allez exécuter le script avec des droits d’administrateur local.</span><span class="sxs-lookup"><span data-stu-id="4b32c-180">Sign in to the machine that you will run the script from with local administrator rights.</span></span>
2. <span data-ttu-id="4b32c-181">Téléchargez ou copiez le script Get-AllTenantRulesAndForms. ps1 depuis GitHub vers un dossier à partir duquel vous allez l’exécuter.</span><span class="sxs-lookup"><span data-stu-id="4b32c-181">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span>  <span data-ttu-id="4b32c-182">Le script crée deux fichiers de date marqués dans ce dossier, MailboxFormsExport-yyyy-mm-dd. csv et MailboxRulesExport-yyyy-mm-dd. csv.</span><span class="sxs-lookup"><span data-stu-id="4b32c-182">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>
3. <span data-ttu-id="4b32c-183">Ouvrez une instance PowerShell en tant qu’administrateur et ouvrez le dossier dans lequel vous avez enregistré le script.</span><span class="sxs-lookup"><span data-stu-id="4b32c-183">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>
4. <span data-ttu-id="4b32c-184">Exécutez cette ligne de commande PowerShell comme `.\Get-AllTenantRulesAndForms.ps1`suit .\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="4b32c-184">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="4b32c-185">Interprétation de la sortie</span><span class="sxs-lookup"><span data-stu-id="4b32c-185">Interpreting the output</span></span>

<span data-ttu-id="4b32c-186">MailboxRulesExport-*yyyy-mm-dd*. csv – examinez les règles (une par ligne) pour les conditions d’action qui incluent des applications ou des exécutables.</span><span class="sxs-lookup"><span data-stu-id="4b32c-186">MailboxRulesExport-*yyyy-mm-dd*.csv – examine the rules (one per row) for action conditions that include applications or executables.</span></span>
- <span data-ttu-id="4b32c-187">ActionType (colonne A): Si vous voyez la valeur «ID_ACTION_CUSTOM», la règle est probablement malveillante.</span><span class="sxs-lookup"><span data-stu-id="4b32c-187">ActionType (column A) – if you see the value “ID_ACTION_CUSTOM”, the rule is likely malicious.</span></span>
- <span data-ttu-id="4b32c-188">IsPotentiallyMalicious (colonne D): si cette valeur est «TRUE», la règle est probablement malveillante.</span><span class="sxs-lookup"><span data-stu-id="4b32c-188">IsPotentiallyMalicious (column D) – if this value is “TRUE”, the rule is likely malicious.</span></span>
- <span data-ttu-id="4b32c-189">ActionCommand (colonne G): si cette énumération répertorie une application ou un fichier avec une extension. exe,. zip ou une entrée qui fait référence à une URL qui n’est pas censée exister, la règle est probablement malveillante.</span><span class="sxs-lookup"><span data-stu-id="4b32c-189">ActionCommand (column G) – if this lists an application or any file with a .exe, .zip extension or an entry that refers to a URL, that is not supposed to be there, the rule is likely malicious.</span></span>

<span data-ttu-id="4b32c-190">MailboxFormsExport-*yyyy-mm-dd*. csv – en général, l’utilisation de formulaires personnalisés est très rare.</span><span class="sxs-lookup"><span data-stu-id="4b32c-190">MailboxFormsExport-*yyyy-mm-dd*.csv – in general, the use of custom forms is very rare.</span></span>  <span data-ttu-id="4b32c-191">Si vous en trouvez dans ce classeur, vous ouvrez la boîte aux lettres de cet utilisateur et examinez le formulaire lui-même.</span><span class="sxs-lookup"><span data-stu-id="4b32c-191">If you find any in this workbook, you open that user’s mailbox and examine the form itself.</span></span>  <span data-ttu-id="4b32c-192">Si votre organisation ne l’a pas placée intentionnellement, elle est probablement malveillante.</span><span class="sxs-lookup"><span data-stu-id="4b32c-192">If your organization did not put it there intentionally, it is likely malicious.</span></span>



## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="4b32c-193">Comment arrêter et corriger les attaques de formulaires et de formulaires Outlook</span><span class="sxs-lookup"><span data-stu-id="4b32c-193">How to stop and remediate the Outlook Rules and Forms attack</span></span>
<span data-ttu-id="4b32c-194">Si vous trouvez des preuves de l’une de ces attaques, la correction est simple, supprimez simplement la règle ou le formulaire de la boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="4b32c-194">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="4b32c-195">Vous pouvez effectuer cette opération avec le client Outlook ou à l’aide de PowerShell à distance pour supprimer des règles.</span><span class="sxs-lookup"><span data-stu-id="4b32c-195">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="4b32c-196">Utilisation d’Outlook</span><span class="sxs-lookup"><span data-stu-id="4b32c-196">Using Outlook</span></span>
1. <span data-ttu-id="4b32c-197">Identifier tous les appareils utilisés par l’utilisateur avec Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-197">Identify all the devices that the user has used with Outlook.</span></span>  <span data-ttu-id="4b32c-198">Ils devront tous être nettoyés du programme malveillant potentiel.</span><span class="sxs-lookup"><span data-stu-id="4b32c-198">They will all need to be cleaned of potential malware.</span></span>  <span data-ttu-id="4b32c-199">Ne pas autoriser l’utilisateur à se connecter et à utiliser le courrier électronique jusqu’à ce que tous les appareils soient nettoyés.</span><span class="sxs-lookup"><span data-stu-id="4b32c-199">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>
2. <span data-ttu-id="4b32c-200">Suivez les étapes de la procédure [supprimer une règle](https://support.office.com/article/Delete-a-rule-2F0E7139-F696-4422-8498-44846DB9067F) pour chaque appareil.</span><span class="sxs-lookup"><span data-stu-id="4b32c-200">Follow the steps in [Delete a rule](https://support.office.com/article/Delete-a-rule-2F0E7139-F696-4422-8498-44846DB9067F) for each device.</span></span>
3. <span data-ttu-id="4b32c-201">Si vous n’êtes pas sûr de la présence d’autres programmes malveillants, vous pouvez formater et réinstaller tous les logiciels sur l’appareil.</span><span class="sxs-lookup"><span data-stu-id="4b32c-201">If you are unsure about the presence of other malware, you can format and re-install all the software on the device.</span></span>  <span data-ttu-id="4b32c-202">Pour les appareils mobiles, vous pouvez suivre les étapes des constructeurs pour réinitialiser l’appareil à l’image installée en usine.</span><span class="sxs-lookup"><span data-stu-id="4b32c-202">For mobile devices you can follow the manufacturers steps to reset the device to the factory image.</span></span>
4. <span data-ttu-id="4b32c-203">Installez les versions les plus à jour d’Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-203">Install the most up-to-date versions of Outlook.</span></span>  <span data-ttu-id="4b32c-204">N’oubliez pas que la version actuelle d’Outlook bloque les deux types de cette attaque par défaut.</span><span class="sxs-lookup"><span data-stu-id="4b32c-204">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>
5. <span data-ttu-id="4b32c-205">Une fois que toutes les copies hors connexion de la boîte aux lettres ont été supprimées, réinitialisez le mot de passe de l’utilisateur (utilisez une qualité élevée) et suivez les étapes décrites dans [setup multi-Factor Authentication for Office 365 Users](https://support.office.com/article/Set-up-multi-factor-authentication-for-Office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6) si MFA n’a pas encore été activé.</span><span class="sxs-lookup"><span data-stu-id="4b32c-205">Once all offline copies of the mailbox have been removed, reset the user's password (use a high-quality one) and follow the steps in [Setup multi-factor authentication for Office 365 users](https://support.office.com/article/Set-up-multi-factor-authentication-for-Office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6) if MFA has not already been enabled.</span></span> <span data-ttu-id="4b32c-206">Cela permet de s’assurer que les informations d’identification de l’utilisateur ne sont pas exposées par d’autres moyens (par exemple, le hameçonnage ou la réutilisation du mot de passe).</span><span class="sxs-lookup"><span data-stu-id="4b32c-206">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="4b32c-207">Utiliser PowerShell</span><span class="sxs-lookup"><span data-stu-id="4b32c-207">Using PowerShell</span></span>
<span data-ttu-id="4b32c-208">Il existe deux cmdlets PowerShell à distance que vous pouvez utiliser pour supprimer ou désactiver les règles dangereuses.</span><span class="sxs-lookup"><span data-stu-id="4b32c-208">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="4b32c-209">Suivez simplement les étapes.</span><span class="sxs-lookup"><span data-stu-id="4b32c-209">Just follow the steps.</span></span>
 
<span data-ttu-id="4b32c-210">Étapes pour les boîtes aux lettres qui se trouvent sur un serveur Exchange</span><span class="sxs-lookup"><span data-stu-id="4b32c-210">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="4b32c-211">Connectez-vous au serveur Exchange à l’aide de PowerShell à distance.</span><span class="sxs-lookup"><span data-stu-id="4b32c-211">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="4b32c-212">Suivez les étapes de la procédure [connexion à des serveurs Exchange à l’aide de PowerShell à distance](https://docs.microsoft.com/powershell/exchange/exchange-server/connect-to-exchange-servers-using-remote-powershell?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="4b32c-212">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-server/connect-to-exchange-servers-using-remote-powershell?view=exchange-ps).</span></span>
2. <span data-ttu-id="4b32c-213">Si vous souhaitez supprimer entièrement une seule règle, plusieurs règles ou toutes les règles d’une boîte aux lettres, utilisez la [cmdlet Remove-Inbox Rule ](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps): utilisez cette commande pour supprimer complètement une, plusieurs ou toutes les règles de la boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="4b32c-213">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule cmdlet ](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps)- use this to completely remove one, multiple, or all rules from the mailbox.</span></span>
3. <span data-ttu-id="4b32c-214">Si vous souhaitez conserver la règle et son contenu à des fins d’aide, utilisez la [cmdlet Disable-InboxRule](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span><span class="sxs-lookup"><span data-stu-id="4b32c-214">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span></span> 

<span data-ttu-id="4b32c-215">Étapes pour les boîtes aux lettres dans Exchange Online</span><span class="sxs-lookup"><span data-stu-id="4b32c-215">Steps for mailboxes in Exchange Online</span></span>
1. <span data-ttu-id="4b32c-216">Suivez les étapes de la procédure [connexion à Exchange Online à l’aide de PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="4b32c-216">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps).</span></span>
2.  <span data-ttu-id="4b32c-217">Si vous souhaitez supprimer entièrement une seule règle, plusieurs règles ou toutes les règles d’une boîte aux lettres, utilisez la [cmdlet Remove-Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="4b32c-217">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule cmdlet](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps).</span></span>
3.  <span data-ttu-id="4b32c-218">Si vous souhaitez conserver la règle et son contenu à des fins d’aide, utilisez la [cmdlet Disable-InboxRule](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span><span class="sxs-lookup"><span data-stu-id="4b32c-218">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span></span> 

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="4b32c-219">Comment limiter les attaques futures</span><span class="sxs-lookup"><span data-stu-id="4b32c-219">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="4b32c-220">Tout d’abord: Protégez vos comptes</span><span class="sxs-lookup"><span data-stu-id="4b32c-220">First: protect your accounts</span></span>

<span data-ttu-id="4b32c-221">Les attaques de formulaires et de règles sont utilisées uniquement par un agresseur après avoir volé ou enfreint un des comptes de vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4b32c-221">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user’s accounts.</span></span> <span data-ttu-id="4b32c-222">Par conséquent, la première étape pour empêcher l’utilisation de ces exploits auprès de votre organisation consiste à protéger activement vos comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b32c-222">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span>  <span data-ttu-id="4b32c-223">Les attaques par hameçonnage ou par [pulvérisation de mot de passe](http://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) constituent certaines des méthodes de violation des comptes les plus courantes.</span><span class="sxs-lookup"><span data-stu-id="4b32c-223">Some of the most common ways that accounts are breached are through phishing or [password spraying](http://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) attacks.</span></span>



<span data-ttu-id="4b32c-224">La meilleure façon de protéger vos comptes d’utilisateur, et en particulier vos comptes administrateur, est de [configurer l’authentification multifacteur pour les utilisateurs d’Office 365](https://support.office.com/article/set-up-multi-factor-authentication-for-office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6).</span><span class="sxs-lookup"><span data-stu-id="4b32c-224">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for Office 365 users](https://support.office.com/article/set-up-multi-factor-authentication-for-office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6).</span></span>  <span data-ttu-id="4b32c-225">Vous devez également:</span><span class="sxs-lookup"><span data-stu-id="4b32c-225">You should also:</span></span>
<ol>
    <li><span data-ttu-id="4b32c-226">Surveillez le mode d' <a href="https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports">accès et d’utilisation</a>de vos comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b32c-226">Monitor how your user accounts are <a href="https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports">accessed and used</a>.</span></span> <span data-ttu-id="4b32c-227">Vous n’êtes pas autorisé à empêcher la violation initiale, mais vous réduisez la durée et l’impact de la violation en la détectant plus tôt.</span><span class="sxs-lookup"><span data-stu-id="4b32c-227">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="4b32c-228">Vous pouvez utiliser les <a href="https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security">stratégies de sécurité d’application Cloud d’Office 365</a> pour surveiller les comptes et alerter les activités inhabituelles.</span><span class="sxs-lookup"><span data-stu-id="4b32c-228">You can use these: <a href="https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security"> Office 365 Cloud App Security policies</a> to monitor you accounts and alert on unusual activity.</span></span> 
        <ol type="a">
            <li><span data-ttu-id="4b32c-229"><b>Plusieurs tentatives de connexion ayant échoué</b> Cette stratégie Profile votre environnement et déclenche des alertes lorsque les utilisateurs effectuent plusieurs activités de connexion ayant échoué au cours d’une session unique en ce qui concerne la planification d’expérience utilisateur, ce qui peut indiquer une tentative de violation.</span><span class="sxs-lookup"><span data-stu-id="4b32c-229"><b>Multiple failed login attempts</b> This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span></li>
            <li><span data-ttu-id="4b32c-230"><b>Déplacement impossible</b> - Cette stratégie Profile votre environnement et déclenche des alertes lorsque des activités sont détectées à partir du même utilisateur dans des emplacements différents pendant une période de temps qui est plus courte que le temps de trajet prévu entre les deux emplacements.</span><span class="sxs-lookup"><span data-stu-id="4b32c-230"><b>Impossible travel</b> - This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="4b32c-231">Cela peut indiquer qu’un autre utilisateur utilise les mêmes informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="4b32c-231">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="4b32c-232">La détection de ce comportement anormal nécessite une période d’apprentissage initiale de sept jours pendant laquelle il apprend le modèle d’activité d’un nouvel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4b32c-232">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user’s activity pattern.</span></span></li>
            <li><span data-ttu-id="4b32c-233"><b>Activité usurpée inhabituelle (par utilisateur)</b> - Cette stratégie Profile votre environnement et déclenche des alertes lorsque les utilisateurs effectuent plusieurs activités empruntées dans une session unique en ce qui concerne la base de référence apprise, ce qui peut indiquer une tentative de violation.</span><span class="sxs-lookup"><span data-stu-id="4b32c-233"><b>Unusual impersonated activity (by user)</b> - This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span></li>
        </ol>
    </li>
    <li><span data-ttu-id="4b32c-234">Utilisez un outil tel que le <a href="https://securescore.office.com/">score de sécurité Office 365</a> pour gérer les configurations et les comportements de sécurité des comptes.</span><span class="sxs-lookup"><span data-stu-id="4b32c-234">Leverage a tool like the <a href="https://securescore.office.com/">Office 365 Secure Score</a> to manage account security configurations and behaviors.</span></span> 
    </li>
</ol> 

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="4b32c-235">Seconde: conserver vos clients Outlook à jour</span><span class="sxs-lookup"><span data-stu-id="4b32c-235">Second: Keep your Outlook clients current</span></span>
<span data-ttu-id="4b32c-236">Les versions entièrement mises à jour et corrigées d’Outlook 2013 et 2016 désactivent par défaut l’action «démarrer l’application».</span><span class="sxs-lookup"><span data-stu-id="4b32c-236">Fully-updated and patched versions of Outlook 2013, and 2016 disable the “Start Application” rule/form action by default.</span></span>  <span data-ttu-id="4b32c-237">Ainsi, même si un agresseur enfreint le compte, les actions de la règle et du formulaire sont bloquées.</span><span class="sxs-lookup"><span data-stu-id="4b32c-237">This will ensure that, even if an attacker breaches the account, the rule and form actions will be blocked.</span></span>  <span data-ttu-id="4b32c-238">Vous pouvez installer les mises à jour les plus récentes et les correctifs de sécurité en suivant les étapes décrites dans [install Office updates](https://support.office.com/article/Install-Office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5).</span><span class="sxs-lookup"><span data-stu-id="4b32c-238">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.office.com/article/Install-Office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="4b32c-239">Voici les versions de correctifs pour vos clients Outlook 2013 et 2016:</span><span class="sxs-lookup"><span data-stu-id="4b32c-239">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>
- <span data-ttu-id="4b32c-240">Outlook 2013:15.0.4937.1000 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="4b32c-240">Outlook 2013: 15.0.4937.1000 or greater</span></span>
- <span data-ttu-id="4b32c-241">Outlook 2016:16.0.4534.1001 ou version ultérieure</span><span class="sxs-lookup"><span data-stu-id="4b32c-241">Outlook 2016: 16.0.4534.1001 or greater</span></span>

<span data-ttu-id="4b32c-242">Pour plus d’informations sur les correctifs de sécurité individuels, voir:</span><span class="sxs-lookup"><span data-stu-id="4b32c-242">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="4b32c-243">Correctif de sécurité Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="4b32c-243">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/en-us/help/3191938) 
- [<span data-ttu-id="4b32c-244">Correctif de sécurité Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4b32c-244">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/en-us/help/3191883)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="4b32c-245">Troisième: surveiller vos clients Outlook</span><span class="sxs-lookup"><span data-stu-id="4b32c-245">Third: Monitor your Outlook clients</span></span>
<span data-ttu-id="4b32c-246">Notez que même avec les correctifs et mises à jour installés, il est possible pour un agresseur de modifier la configuration de l’ordinateur local pour réactiver le comportement «démarrer l’application».</span><span class="sxs-lookup"><span data-stu-id="4b32c-246">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the “Start Application” behavior.</span></span> <span data-ttu-id="4b32c-247">Vous pouvez utiliser la [gestion de stratégie de groupe avancée](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) pour surveiller et appliquer des stratégies d’ordinateur local sur vos clients.</span><span class="sxs-lookup"><span data-stu-id="4b32c-247">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>  
<span data-ttu-id="4b32c-248">Vous pouvez voir si «démarrer l’application» a été réactivé via une substitution dans le registre à l’aide des informations de la rubrique [How to View the System Registry by using 64-bit versions of Windows](https://support.microsoft.com/en-us/help/305097/how-to-view-the-system-registry-by-using-64-bit-versions-of-windows).</span><span class="sxs-lookup"><span data-stu-id="4b32c-248">You can to see if “Start Application” has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/en-us/help/305097/how-to-view-the-system-registry-by-using-64-bit-versions-of-windows).</span></span>  <span data-ttu-id="4b32c-249">Vérifiez les sous-clés suivantes:</span><span class="sxs-lookup"><span data-stu-id="4b32c-249">Check these subkeys:</span></span> 

- <span data-ttu-id="4b32c-250">Outlook 2016: HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\\</span><span class="sxs-lookup"><span data-stu-id="4b32c-250">Outlook 2016: HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\\</span></span>
- <span data-ttu-id="4b32c-251">Outlook 2013: HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\\</span><span class="sxs-lookup"><span data-stu-id="4b32c-251">Outlook 2013: HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\\</span></span>

<span data-ttu-id="4b32c-252">Recherchez la clé EnableUnsafeClientMailRules.</span><span class="sxs-lookup"><span data-stu-id="4b32c-252">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="4b32c-253">S’il est présent et qu’il est défini sur 1, le correctif de sécurité Outlook a été remplacé et l’ordinateur est vulnérable à l’attaque de formulaire/de règles.</span><span class="sxs-lookup"><span data-stu-id="4b32c-253">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="4b32c-254">Si la valeur est égale à 0, l’action «démarrer l’application» est désactivée.</span><span class="sxs-lookup"><span data-stu-id="4b32c-254">If the value is 0, the “Start Application” action is disabled.</span></span>  <span data-ttu-id="4b32c-255">Si la version mise à jour et corrigée d’Outlook est installée et que cette clé de Registre n’est pas présente, un système n’est pas vulnérable à ces attaques.</span><span class="sxs-lookup"><span data-stu-id="4b32c-255">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="4b32c-256">Les clients disposant d’installations Exchange locales doivent envisager de bloquer les anciennes versions d’Outlook qui n’ont pas de correctifs disponibles.</span><span class="sxs-lookup"><span data-stu-id="4b32c-256">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="4b32c-257">Pour plus d’informations sur ce processus, voir l’article [configurer le blocage du client Outlook](https://technet.microsoft.com/en-us/library/dd335207(v=exchg.150).aspx).</span><span class="sxs-lookup"><span data-stu-id="4b32c-257">Details on this process can be found in the article [Configure Outlook client blocking](https://technet.microsoft.com/en-us/library/dd335207(v=exchg.150).aspx).</span></span>

## <a name="secure-office-365-like-a-cybersecurity-pro"></a><span data-ttu-id="4b32c-258">Sécuriser Office 365 comme un pro de la cyber-sécurité</span><span class="sxs-lookup"><span data-stu-id="4b32c-258">Secure Office 365 like a cybersecurity pro</span></span>
<span data-ttu-id="4b32c-259">Votre abonnement Office 365 inclut un ensemble puissant de fonctionnalités de sécurité que vous pouvez utiliser pour protéger vos données et vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4b32c-259">Your Office 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span>  <span data-ttu-id="4b32c-260">Utilisez la [Feuille de route pour sécuriser Office 365 : principales priorités pour les 30 premiers jours, 90 premiers jours et au-delà](https://support.office.com/article/Office-365-security-roadmap-Top-priorities-for-the-first-30-days-90-days-and-beyond-28c86a1c-e4dd-4aad-a2a6-c768a21cb352), pour implémenter les meilleures pratiques recommandées par Microsoft pour sécuriser votre client Office 365.</span><span class="sxs-lookup"><span data-stu-id="4b32c-260">Use the [Office 365 security roadmap: Top priorities for the first 30 days, 90 days, and beyond](https://support.office.com/article/Office-365-security-roadmap-Top-priorities-for-the-first-30-days-90-days-and-beyond-28c86a1c-e4dd-4aad-a2a6-c768a21cb352) to implement Microsoft recommended best practices for securing your Office 365 tenant.</span></span>
- <span data-ttu-id="4b32c-261">Tâches à effectuer lors des 30 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="4b32c-261">Tasks to accomplish in the first 30 days.</span></span>  <span data-ttu-id="4b32c-262">Elle ont un effet immédiat et n’ont qu’un faible impact négatif sur vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4b32c-262">These have immediate affect and are low-impact to your users.</span></span>
- <span data-ttu-id="4b32c-263">Tâches à accomplir dans les 90 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="4b32c-263">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="4b32c-264">Ces tâches prennent un peu plus de temps à planifier et à implémenter, mais augmentent considérablement votre sécurité.</span><span class="sxs-lookup"><span data-stu-id="4b32c-264">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>
- <span data-ttu-id="4b32c-265">Au-delà de 90 jours.</span><span class="sxs-lookup"><span data-stu-id="4b32c-265">Beyond 90 days.</span></span> <span data-ttu-id="4b32c-266">Ces améliorations sont à mettre en place pendant les 90 premiers jours.</span><span class="sxs-lookup"><span data-stu-id="4b32c-266">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="4b32c-267">Voir aussi :</span><span class="sxs-lookup"><span data-stu-id="4b32c-267">See also:</span></span>
- <span data-ttu-id="4b32c-268">[Règles Outlook malveillantes](https://silentbreaksecurity.com/malicious-outlook-rules/) par SilentBreak Security post à propos des règles le vecteur fournit une analyse détaillée de la façon dont les règles Outlook sont définies.</span><span class="sxs-lookup"><span data-stu-id="4b32c-268">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span> 
- <span data-ttu-id="4b32c-269">[MAPI sur http et Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) sur le blog Sensepost sur Mailrule Pwnage aborde un outil appelé Ruler qui vous permet d’exploiter les boîtes aux lettres par le biais de règles Outlook.</span><span class="sxs-lookup"><span data-stu-id="4b32c-269">[MAPI over HTTP and Mailrule Pwnage ](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>
- <span data-ttu-id="4b32c-270">[Formulaires et coques Outlook](https://sensepost.com/blog/2017/outlook-forms-and-shells/) sur le blog Sensepost sur le vecteur de menace de formulaires.</span><span class="sxs-lookup"><span data-stu-id="4b32c-270">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span> 
- [<span data-ttu-id="4b32c-271">CodeBase de règle</span><span class="sxs-lookup"><span data-stu-id="4b32c-271">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)
- [<span data-ttu-id="4b32c-272">Indicateurs de règle compromis</span><span class="sxs-lookup"><span data-stu-id="4b32c-272">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)